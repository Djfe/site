From 697cc96f7ce11f292cae7e437e646c12842a4723 Mon Sep 17 00:00:00 2001
From: Florian Maurer <f.maurer@outlook.de>
Date: Sun, 11 Dec 2022 20:01:32 +0100
Subject: [PATCH 1/2] lantiq-xrx200: add Arcadyan VGV7510KW22 (o2 Box 6431)

---
 docs/user/supported_devices.rst                             | 4 ++++
 package/gluon-core/luasrc/lib/gluon/upgrade/010-primary-mac | 3 +++
 package/gluon-core/luasrc/lib/gluon/upgrade/020-interfaces  | 4 ++++
 targets/lantiq-xrx200                                       | 5 +++++
 4 files changed, 16 insertions(+)

diff --git a/docs/user/supported_devices.rst b/docs/user/supported_devices.rst
index d4727adaf1..54b8e26e6d 100644
--- a/docs/user/supported_devices.rst
+++ b/docs/user/supported_devices.rst
@@ -238,6 +238,10 @@ ipq806x-generic
 lantiq-xrx200
 -------------
 
+* Arcadyan
+
+  - VGV7510KW22 (o2 Box 6431)
+
 * AVM
 
   - FRITZ!Box 7360 (v1, v2) [#avmflash]_ [#lan_as_wan]_
diff --git a/package/gluon-core/luasrc/lib/gluon/upgrade/010-primary-mac b/package/gluon-core/luasrc/lib/gluon/upgrade/010-primary-mac
index 597201f3..7244caef 100755
--- a/package/gluon-core/luasrc/lib/gluon/upgrade/010-primary-mac
+++ b/package/gluon-core/luasrc/lib/gluon/upgrade/010-primary-mac
@@ -87,6 +87,10 @@ local primary_addrs = {
                {'ipq806x', 'generic', {
                        'netgear,r7800',
                }},
+               {'lantiq', 'xrx200', {
+                       'arcadyan,vgv7510kw22-nor',
+                       'avm,fritz7430',
+               }},
                {'lantiq', 'xway', {
                        'netgear,dgn3500b',
                }},
diff --git a/package/gluon-core/luasrc/lib/gluon/upgrade/020-interfaces b/package/gluon-core/luasrc/lib/gluon/upgrade/020-interfaces
index 997c115974..fe34b849d0 100755
--- a/package/gluon-core/luasrc/lib/gluon/upgrade/020-interfaces
+++ b/package/gluon-core/luasrc/lib/gluon/upgrade/020-interfaces
@@ -67,6 +67,10 @@ elseif platform.match('ramips', 'mt7621', {
 	'netgear,wac104',
 }) then
 	lan_ifname, wan_ifname = 'lan2 lan3 lan4', 'lan1'
+elseif platform.match('lantiq', 'xrx200', {
+	'arcadyan,vgv7510kw22-nor',
+}) then
+	lan_ifname, wan_ifname = 'lan2 lan3 lan4', 'lan1'
 elseif platform.match('realtek', 'rtl838x', {
 	'd-link,dgs-1210-10p',
 }) then
diff --git a/targets/lantiq-xrx200 b/targets/lantiq-xrx200
index 047db6da..978fb2af 100644
--- a/targets/lantiq-xrx200
+++ b/targets/lantiq-xrx200
@@ -47,6 +47,15 @@ device('avm-fritz-box-7412', 'avm_fritz7412', {
        factory = false,
 })
 
+device('avm-fritz-box-7430', 'avm_fritz7430', {
+       factory = false,
+})
+
+device('arcadyan-vgv7510kw22', 'arcadyan_vgv7510kw22-nor', {
+       factory = false,
+       aliases = {'o2-box-6431'},
+})
+
 -- TP-Link
 
 -- CAVEAT: These devices don't have a dedicated WAN port.

From 264ec4bdf6c0cbbc68ada925eefcccf157befe57 Mon Sep 17 00:00:00 2001
From: Florian Maurer <f.maurer@outlook.de>
Date: Sun, 11 Dec 2022 21:49:17 +0100
Subject: [PATCH 2/2] update lan, wan separation for o2 6431

---
 package/gluon-core/luasrc/lib/gluon/upgrade/020-interfaces | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/package/gluon-core/luasrc/lib/gluon/upgrade/020-interfaces b/package/gluon-core/luasrc/lib/gluon/upgrade/020-interfaces
index fe34b849d0..063ab1a1d5 100755
--- a/package/gluon-core/luasrc/lib/gluon/upgrade/020-interfaces
+++ b/package/gluon-core/luasrc/lib/gluon/upgrade/020-interfaces
@@ -70,7 +70,7 @@ elseif platform.match('ramips', 'mt7621', {
 elseif platform.match('lantiq', 'xrx200', {
 	'arcadyan,vgv7510kw22-nor',
 }) then
-	lan_ifname, wan_ifname = 'lan2 lan3 lan4', 'lan1'
+	lan_ifname, wan_ifname = 'lan1 lan2 lan3 lan4', 'wan'
 elseif platform.match('realtek', 'rtl838x', {
 	'd-link,dgs-1210-10p',
 }) then
